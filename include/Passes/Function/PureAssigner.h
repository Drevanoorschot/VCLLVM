#ifndef VCLLVM_PUREASSIGNER_H
#define VCLLVM_PUREASSIGNER_H

#include <llvm/IR/PassManager.h>
#include "col.pb.h"
/**
 * The PureAssignerPass checks if a LLVM function is pure (i.e. whether the !VC.pure metadata node is set)
 */
namespace vcllvm {
    using namespace llvm;
    namespace col = vct::col::serialize;

    class PureAssignerPass : public PassInfoMixin<PureAssignerPass> {
    private:
        std::shared_ptr<col::Program> pProgram;
    public:
        explicit PureAssignerPass(std::shared_ptr<col::Program> pProgram);

        PreservedAnalyses run(Function &F, FunctionAnalysisManager &FAM);
    };
    /**
     * Helper function to generate errors generated by this Pass
     * @param F
     * @param explanation
     */
    void reportError(Function &F, const std::string &explanation);
}
#endif //VCLLVM_PUREASSIGNER_H
